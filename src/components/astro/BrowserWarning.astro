---
import { loadNamespaces } from "../../i18n/i18n";
import { getLocaleEx } from "../../i18n/i18n-aut-ex";

// i18next
const locale = getLocaleEx(Astro);
const namespaces = ["landing"];
await loadNamespaces(locale, namespaces);
---

<div class="top-panel disabled">
    <p>Your browser currently does not support some of the features used on this side. Viewing experience may not be optimal.</p>
    <i class="gg-close"></i>
</div>

<style>
    @import url("css.gg/icons/css/close.css");

    .top-panel {
        position: fixed;
        top: 0;
        width: 100%;
        min-height: 50px;
        background-color: rgba(255, 204, 0, 1);
        display: inline-flex;
        align-items: center;
        color: black;
        transition: transform 400ms ease-in-out;
        z-index: 3000;

        & p {
            padding: 1rem;
            margin-left: auto;
        }

        .gg-close {
            color: inherit;
            margin-left: auto;
            padding-right: 2rem;
            cursor: pointer;
            transform: scale(1.3);
        }

        &.disabled {
            display: none;
        }

        &.hidden {
            transform: translateY(-100%);
        }
    }
</style>

<script>
    const showWarning = () => {
        const topPanel = document.querySelector<HTMLDivElement>(".top-panel");
        const topPanelButton = topPanel?.querySelector(".gg-close");
        const warningShown = window.localStorage.getItem("warningShown");

        if (warningShown === "true") {
            return;
        }

        topPanel?.classList.remove("disabled");
        window.localStorage.setItem("warningShown", "true");

        topPanelButton?.addEventListener("click", () => {
            topPanel?.classList.add("hidden");
        });

        setTimeout(() => {
            topPanel?.classList.add("hidden");
        }, 3500);
    };
    showWarning();
</script>
